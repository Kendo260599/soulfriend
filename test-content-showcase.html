<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoulFriend Content Showcase Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f7f6;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: auto;
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        .section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fdfdfd;
        }
        .status-ok { color: #28a745; font-weight: bold; }
        .status-error { color: #dc3545; font-weight: bold; }
        .status-warn { color: #ffc107; font-weight: bold; }
        .status-info { color: #17a2b8; font-weight: bold; }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button:hover { background-color: #0056b3; }
        pre {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #007bff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .test-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: #f9f9f9;
        }
        .test-card h3 {
            margin-top: 0;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 SoulFriend Content Showcase Test</h1>
        <p>Kiểm tra tính năng mới của SoulFriend V4.0 - Content Showcase Landing Page và Content Overview Page</p>

        <div class="section">
            <h2>1. Frontend Server Status</h2>
            <p><strong>URL:</strong> <span id="frontendUrl">http://localhost:3000</span></p>
            <p><strong>Status:</strong> <span id="frontendStatus">Checking...</span></p>
            <button onclick="checkFrontend()">Check Frontend</button>
            <pre id="frontendResponse"></pre>
        </div>

        <div class="section">
            <h2>2. Landing Page Test</h2>
            <p><strong>Test:</strong> Content Showcase Landing Page</p>
            <p><strong>Status:</strong> <span id="landingStatus">Checking...</span></p>
            <button onclick="testLandingPage()">Test Landing Page</button>
            <pre id="landingResponse"></pre>
        </div>

        <div class="section">
            <h2>3. Content Overview Page Test</h2>
            <p><strong>Test:</strong> Content Overview Page với search và navigation</p>
            <p><strong>Status:</strong> <span id="overviewStatus">Checking...</span></p>
            <button onclick="testContentOverview()">Test Content Overview</button>
            <pre id="overviewResponse"></pre>
        </div>

        <div class="section">
            <h2>4. Navigation Flow Test</h2>
            <p><strong>Test:</strong> Navigation giữa các pages</p>
            <p><strong>Status:</strong> <span id="navigationStatus">Checking...</span></p>
            <button onclick="testNavigationFlow()">Test Navigation</button>
            <pre id="navigationResponse"></pre>
        </div>

        <div class="section">
            <h2>5. Mobile Responsiveness Test</h2>
            <p><strong>Test:</strong> Responsive design trên mobile</p>
            <p><strong>Status:</strong> <span id="mobileStatus">Checking...</span></p>
            <button onclick="testMobileResponsiveness()">Test Mobile</button>
            <pre id="mobileResponse"></pre>
        </div>

        <div class="section">
            <h2>6. Search Functionality Test</h2>
            <p><strong>Test:</strong> Search và filter functionality</p>
            <p><strong>Status:</strong> <span id="searchStatus">Checking...</span></p>
            <button onclick="testSearchFunctionality()">Test Search</button>
            <pre id="searchResponse"></pre>
        </div>

        <div class="section">
            <h2>7. Content Showcase Features Test</h2>
            <p><strong>Test:</strong> Các tính năng showcase content</p>
            <p><strong>Status:</strong> <span id="featuresStatus">Checking...</span></p>
            <button onclick="testContentFeatures()">Test Features</button>
            <pre id="featuresResponse"></pre>
        </div>

        <button onclick="runAllTests()">🚀 Run All Tests</button>
        <div id="overallStatus" style="margin-top: 20px; font-size: 1.2em;"></div>
    </div>

    <script>
        const FRONTEND_URL = 'http://localhost:3000';

        async function fetchData(url, options = {}) {
            try {
                const response = await fetch(url, options);
                const text = await response.text();
                try {
                    const json = JSON.parse(text);
                    return { ok: response.ok, status: response.status, data: json, raw: text };
                } catch (e) {
                    return { ok: response.ok, status: response.status, data: text, raw: text };
                }
            } catch (error) {
                return { ok: false, status: 0, error: error.message, raw: error.message };
            }
        }

        function updateStatus(elementId, statusClass, message, responseElementId, responseData) {
            document.getElementById(elementId).className = statusClass;
            document.getElementById(elementId).textContent = message;
            if (responseElementId && responseData) {
                document.getElementById(responseElementId).textContent = JSON.stringify(responseData, null, 2);
            }
        }

        async function checkFrontend() {
            updateStatus('frontendStatus', 'status-info', 'Checking...', 'frontendResponse', 'Loading...');
            const result = await fetchData(FRONTEND_URL);
            if (result.ok) {
                updateStatus('frontendStatus', 'status-ok', 'Frontend is RUNNING!', 'frontendResponse', {
                    status: 'OK',
                    message: 'Frontend server is running successfully',
                    url: FRONTEND_URL
                });
            } else {
                updateStatus('frontendStatus', 'status-error', `Error: ${result.status} - ${result.error || result.raw}`, 'frontendResponse', result.raw);
            }
            return result.ok;
        }

        async function testLandingPage() {
            updateStatus('landingStatus', 'status-info', 'Testing...', 'landingResponse', 'Loading...');
            
            // Test landing page content
            const landingTests = [
                {
                    name: 'Hero Section',
                    test: () => {
                        // Check if landing page loads
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('SoulFriend V4.0')) {
                                return { status: 'PASS', message: 'Hero section found' };
                            }
                            return { status: 'FAIL', message: 'Hero section not found' };
                        });
                    }
                },
                {
                    name: 'Feature Showcase',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('13 Psychological Tests')) {
                                return { status: 'PASS', message: 'Feature showcase found' };
                            }
                            return { status: 'FAIL', message: 'Feature showcase not found' };
                        });
                    }
                },
                {
                    name: 'Stats Container',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && (result.raw.includes('13') || result.raw.includes('96%'))) {
                                return { status: 'PASS', message: 'Stats container found' };
                            }
                            return { status: 'FAIL', message: 'Stats container not found' };
                        });
                    }
                },
                {
                    name: 'CTA Buttons',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Khám phá ngay')) {
                                return { status: 'PASS', message: 'CTA buttons found' };
                            }
                            return { status: 'FAIL', message: 'CTA buttons not found' };
                        });
                    }
                }
            ];

            const results = [];
            for (const test of landingTests) {
                try {
                    const result = await test.test();
                    results.push({ name: test.name, ...result });
                } catch (error) {
                    results.push({ name: test.name, status: 'ERROR', message: error.message });
                }
            }

            const passedTests = results.filter(r => r.status === 'PASS').length;
            const totalTests = results.length;

            if (passedTests === totalTests) {
                updateStatus('landingStatus', 'status-ok', `Landing Page: ${passedTests}/${totalTests} tests PASSED!`, 'landingResponse', results);
            } else {
                updateStatus('landingStatus', 'status-warn', `Landing Page: ${passedTests}/${totalTests} tests passed`, 'landingResponse', results);
            }

            return passedTests === totalTests;
        }

        async function testContentOverview() {
            updateStatus('overviewStatus', 'status-info', 'Testing...', 'overviewResponse', 'Loading...');
            
            // Test content overview page features
            const overviewTests = [
                {
                    name: 'Navigation Tabs',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Tất cả') && result.raw.includes('Tests Tâm lý')) {
                                return { status: 'PASS', message: 'Navigation tabs found' };
                            }
                            return { status: 'FAIL', message: 'Navigation tabs not found' };
                        });
                    }
                },
                {
                    name: 'Search Functionality',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Tìm kiếm')) {
                                return { status: 'PASS', message: 'Search input found' };
                            }
                            return { status: 'FAIL', message: 'Search input not found' };
                        });
                    }
                },
                {
                    name: 'Content Categories',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Psychological Tests') && result.raw.includes('AI Chatbot')) {
                                return { status: 'PASS', message: 'Content categories found' };
                            }
                            return { status: 'FAIL', message: 'Content categories not found' };
                        });
                    }
                },
                {
                    name: 'Test Grid',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && (result.raw.includes('DASS-21') || result.raw.includes('PHQ-9'))) {
                                return { status: 'PASS', message: 'Test grid found' };
                            }
                            return { status: 'FAIL', message: 'Test grid not found' };
                        });
                    }
                }
            ];

            const results = [];
            for (const test of overviewTests) {
                try {
                    const result = await test.test();
                    results.push({ name: test.name, ...result });
                } catch (error) {
                    results.push({ name: test.name, status: 'ERROR', message: error.message });
                }
            }

            const passedTests = results.filter(r => r.status === 'PASS').length;
            const totalTests = results.length;

            if (passedTests === totalTests) {
                updateStatus('overviewStatus', 'status-ok', `Content Overview: ${passedTests}/${totalTests} tests PASSED!`, 'overviewResponse', results);
            } else {
                updateStatus('overviewStatus', 'status-warn', `Content Overview: ${passedTests}/${totalTests} tests passed`, 'overviewResponse', results);
            }

            return passedTests === totalTests;
        }

        async function testNavigationFlow() {
            updateStatus('navigationStatus', 'status-info', 'Testing...', 'navigationResponse', 'Loading...');
            
            // Test navigation flow
            const navigationTests = [
                {
                    name: 'Welcome to Content Overview',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Khám phá Nội dung Chuyên sâu')) {
                                return { status: 'PASS', message: 'Content overview page accessible' };
                            }
                            return { status: 'FAIL', message: 'Content overview page not accessible' };
                        });
                    }
                },
                {
                    name: 'Back Navigation',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Trang chủ')) {
                                return { status: 'PASS', message: 'Back navigation found' };
                            }
                            return { status: 'FAIL', message: 'Back navigation not found' };
                        });
                    }
                },
                {
                    name: 'Feature Links',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && (result.raw.includes('onClick') || result.raw.includes('onView'))) {
                                return { status: 'PASS', message: 'Feature links found' };
                            }
                            return { status: 'FAIL', message: 'Feature links not found' };
                        });
                    }
                }
            ];

            const results = [];
            for (const test of navigationTests) {
                try {
                    const result = await test.test();
                    results.push({ name: test.name, ...result });
                } catch (error) {
                    results.push({ name: test.name, status: 'ERROR', message: error.message });
                }
            }

            const passedTests = results.filter(r => r.status === 'PASS').length;
            const totalTests = results.length;

            if (passedTests === totalTests) {
                updateStatus('navigationStatus', 'status-ok', `Navigation: ${passedTests}/${totalTests} tests PASSED!`, 'navigationResponse', results);
            } else {
                updateStatus('navigationStatus', 'status-warn', `Navigation: ${passedTests}/${totalTests} tests passed`, 'navigationResponse', results);
            }

            return passedTests === totalTests;
        }

        async function testMobileResponsiveness() {
            updateStatus('mobileStatus', 'status-info', 'Testing...', 'mobileResponse', 'Loading...');
            
            // Test mobile responsiveness
            const mobileTests = [
                {
                    name: 'Viewport Meta Tag',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('viewport')) {
                                return { status: 'PASS', message: 'Viewport meta tag found' };
                            }
                            return { status: 'FAIL', message: 'Viewport meta tag not found' };
                        });
                    }
                },
                {
                    name: 'Responsive CSS',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && (result.raw.includes('@media') || result.raw.includes('grid-template-columns'))) {
                                return { status: 'PASS', message: 'Responsive CSS found' };
                            }
                            return { status: 'FAIL', message: 'Responsive CSS not found' };
                        });
                    }
                },
                {
                    name: 'Mobile Navigation',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('flex-wrap')) {
                                return { status: 'PASS', message: 'Mobile navigation found' };
                            }
                            return { status: 'FAIL', message: 'Mobile navigation not found' };
                        });
                    }
                }
            ];

            const results = [];
            for (const test of mobileTests) {
                try {
                    const result = await test.test();
                    results.push({ name: test.name, ...result });
                } catch (error) {
                    results.push({ name: test.name, status: 'ERROR', message: error.message });
                }
            }

            const passedTests = results.filter(r => r.status === 'PASS').length;
            const totalTests = results.length;

            if (passedTests === totalTests) {
                updateStatus('mobileStatus', 'status-ok', `Mobile: ${passedTests}/${totalTests} tests PASSED!`, 'mobileResponse', results);
            } else {
                updateStatus('mobileStatus', 'status-warn', `Mobile: ${passedTests}/${totalTests} tests passed`, 'mobileResponse', results);
            }

            return passedTests === totalTests;
        }

        async function testSearchFunctionality() {
            updateStatus('searchStatus', 'status-info', 'Testing...', 'searchResponse', 'Loading...');
            
            // Test search functionality
            const searchTests = [
                {
                    name: 'Search Input',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Tìm kiếm')) {
                                return { status: 'PASS', message: 'Search input found' };
                            }
                            return { status: 'FAIL', message: 'Search input not found' };
                        });
                    }
                },
                {
                    name: 'Search Placeholder',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('placeholder')) {
                                return { status: 'PASS', message: 'Search placeholder found' };
                            }
                            return { status: 'FAIL', message: 'Search placeholder not found' };
                        });
                    }
                },
                {
                    name: 'Filter Tabs',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Tất cả') && result.raw.includes('Tests Tâm lý')) {
                                return { status: 'PASS', message: 'Filter tabs found' };
                            }
                            return { status: 'FAIL', message: 'Filter tabs not found' };
                        });
                    }
                }
            ];

            const results = [];
            for (const test of searchTests) {
                try {
                    const result = await test.test();
                    results.push({ name: test.name, ...result });
                } catch (error) {
                    results.push({ name: test.name, status: 'ERROR', message: error.message });
                }
            }

            const passedTests = results.filter(r => r.status === 'PASS').length;
            const totalTests = results.length;

            if (passedTests === totalTests) {
                updateStatus('searchStatus', 'status-ok', `Search: ${passedTests}/${totalTests} tests PASSED!`, 'searchResponse', results);
            } else {
                updateStatus('searchStatus', 'status-warn', `Search: ${passedTests}/${totalTests} tests passed`, 'searchResponse', results);
            }

            return passedTests === totalTests;
        }

        async function testContentFeatures() {
            updateStatus('featuresStatus', 'status-info', 'Testing...', 'featuresResponse', 'Loading...');
            
            // Test content showcase features
            const featureTests = [
                {
                    name: '13 Psychological Tests',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('13 Psychological Tests')) {
                                return { status: 'PASS', message: '13 Tests feature found' };
                            }
                            return { status: 'FAIL', message: '13 Tests feature not found' };
                        });
                    }
                },
                {
                    name: 'AI Chatbot CHUN',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('AI Chatbot CHUN')) {
                                return { status: 'PASS', message: 'AI Chatbot feature found' };
                            }
                            return { status: 'FAIL', message: 'AI Chatbot feature not found' };
                        });
                    }
                },
                {
                    name: 'Research Data',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Dữ liệu Nghiên cứu')) {
                                return { status: 'PASS', message: 'Research data feature found' };
                            }
                            return { status: 'FAIL', message: 'Research data feature not found' };
                        });
                    }
                },
                {
                    name: 'Crisis Support',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && result.raw.includes('Crisis Support')) {
                                return { status: 'PASS', message: 'Crisis support feature found' };
                            }
                            return { status: 'FAIL', message: 'Crisis support feature not found' };
                        });
                    }
                },
                {
                    name: 'Stats Display',
                    test: () => {
                        return fetchData(FRONTEND_URL).then(result => {
                            if (result.ok && (result.raw.includes('15.2%') || result.raw.includes('18.7%'))) {
                                return { status: 'PASS', message: 'Stats display found' };
                            }
                            return { status: 'FAIL', message: 'Stats display not found' };
                        });
                    }
                }
            ];

            const results = [];
            for (const test of featureTests) {
                try {
                    const result = await test.test();
                    results.push({ name: test.name, ...result });
                } catch (error) {
                    results.push({ name: test.name, status: 'ERROR', message: error.message });
                }
            }

            const passedTests = results.filter(r => r.status === 'PASS').length;
            const totalTests = results.length;

            if (passedTests === totalTests) {
                updateStatus('featuresStatus', 'status-ok', `Features: ${passedTests}/${totalTests} tests PASSED!`, 'featuresResponse', results);
            } else {
                updateStatus('featuresStatus', 'status-warn', `Features: ${passedTests}/${totalTests} tests passed`, 'featuresResponse', results);
            }

            return passedTests === totalTests;
        }

        async function runAllTests() {
            document.getElementById('overallStatus').innerHTML = '<span class="spinner"></span> Running all tests...';
            
            const results = {
                frontend: await checkFrontend(),
                landing: await testLandingPage(),
                overview: await testContentOverview(),
                navigation: await testNavigationFlow(),
                mobile: await testMobileResponsiveness(),
                search: await testSearchFunctionality(),
                features: await testContentFeatures()
            };

            let allOk = true;
            for (const key in results) {
                if (!results[key]) {
                    allOk = false;
                    break;
                }
            }

            if (allOk) {
                document.getElementById('overallStatus').className = 'status-ok';
                document.getElementById('overallStatus').textContent = '✅ All Tests PASSED! Content Showcase is working perfectly!';
            } else {
                document.getElementById('overallStatus').className = 'status-error';
                document.getElementById('overallStatus').textContent = '❌ Some tests failed. Check individual statuses above.';
            }
        }

        // Auto-run tests on load
        window.onload = () => {
            setTimeout(runAllTests, 2000); // Wait 2 seconds for frontend to start
        };
    </script>
</body>
</html>

