<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Google Gemini API Key</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 600px;
            width: 100%;
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 0.9rem;
        }
        
        .api-key-display {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            word-break: break-all;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            border: 2px solid #e0e0e0;
        }
        
        .button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            width: 100%;
            margin-bottom: 15px;
            transition: transform 0.2s;
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            display: none;
        }
        
        .result.success {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
            display: block;
        }
        
        .result.error {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
            display: block;
        }
        
        .result.loading {
            background: #d1ecf1;
            border: 2px solid #17a2b8;
            color: #0c5460;
            display: block;
        }
        
        .result-title {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .response-text {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
        }
        
        .info {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        
        .info-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .status-success {
            background: #28a745;
            color: white;
        }
        
        .status-error {
            background: #dc3545;
            color: white;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Test Google Gemini API</h1>
        <p class="subtitle">Ki·ªÉm tra API key c√≥ ho·∫°t ƒë·ªông kh√¥ng</p>
        
        <div class="info">
            <div class="info-title">üìã API Key:</div>
            <div class="api-key-display" id="apiKey">AIzaSyBaswf5ksxu1g7WvhS2_Hy7PHqWpjZu8LM</div>
        </div>
        
        <button class="button" id="testBtn" onclick="testAPI()">
            ‚ú® Test API Key
        </button>
        
        <button class="button" id="testChatBtn" onclick="testChat()">
            üí¨ Test Chat (Xin ch√†o)
        </button>
        
        <button class="button" id="testMentalHealthBtn" onclick="testMentalHealth()">
            üß† Test Mental Health Question
        </button>
        
        <div id="result" class="result"></div>
    </div>

    <script>
        const API_KEY = 'AIzaSyBaswf5ksxu1g7WvhS2_Hy7PHqWpjZu8LM';
        const API_URL = 'https://generativelanguage.googleapis.com/v1/models/gemini-2.5-flash:generateContent';

        function showLoading() {
            const result = document.getElementById('result');
            result.className = 'result loading';
            result.innerHTML = `
                <div class="result-title">‚è≥ ƒêang ki·ªÉm tra...</div>
                <div class="spinner"></div>
                <p>Vui l√≤ng ƒë·ª£i trong gi√¢y l√°t...</p>
            `;
        }

        function showSuccess(title, message, response) {
            const result = document.getElementById('result');
            result.className = 'result success';
            result.innerHTML = `
                <div class="result-title">‚úÖ ${title}</div>
                <p>${message}</p>
                <span class="status-badge status-success">API HO·∫†T ƒê·ªòNG</span>
                ${response ? `<div class="response-text">${response}</div>` : ''}
            `;
        }

        function showError(title, error) {
            const result = document.getElementById('result');
            result.className = 'result error';
            result.innerHTML = `
                <div class="result-title">‚ùå ${title}</div>
                <p>${error}</p>
                <span class="status-badge status-error">API KH√îNG HO·∫†T ƒê·ªòNG</span>
            `;
        }

        async function testAPI() {
            showLoading();
            
            try {
                const response = await fetch(`${API_URL}?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: 'Hello, test connection' }]
                        }]
                    })
                });

                if (!response.ok) {
                    const error = await response.text();
                    throw new Error(`HTTP ${response.status}: ${error}`);
                }

                const data = await response.json();
                console.log('‚úÖ API Response:', data);
                
                showSuccess(
                    'K·∫øt n·ªëi th√†nh c√¥ng!', 
                    'API key ho·∫°t ƒë·ªông t·ªët. B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng Gemini trong chatbot.',
                    null
                );

            } catch (error) {
                console.error('‚ùå API Error:', error);
                
                if (error.message.includes('API_KEY_INVALID') || error.message.includes('403')) {
                    showError('API Key kh√¥ng h·ª£p l·ªá', 'API key ƒë√£ h·∫øt h·∫°n ho·∫∑c kh√¥ng ƒë√∫ng. Vui l√≤ng ki·ªÉm tra l·∫°i.');
                } else if (error.message.includes('429')) {
                    showError('V∆∞·ª£t qu√° gi·ªõi h·∫°n', 'API ƒë√£ v∆∞·ª£t qu√° quota. Vui l√≤ng th·ª≠ l·∫°i sau.');
                } else {
                    showError('L·ªói k·∫øt n·ªëi', error.message);
                }
            }
        }

        async function testChat() {
            showLoading();
            
            try {
                const response = await fetch(`${API_URL}?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: 'Xin ch√†o, t√¥i c·∫ßn tr·ª£ gi√∫p v·ªÅ s·ª©c kh·ªèe t√¢m l√Ω' }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 256,
                        }
                    })
                });

                if (!response.ok) {
                    const error = await response.text();
                    throw new Error(`HTTP ${response.status}: ${error}`);
                }

                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || 'No response';
                
                console.log('‚úÖ Chat Response:', text);
                
                showSuccess(
                    'Chat th√†nh c√¥ng!', 
                    'Gemini ƒë√£ ph·∫£n h·ªìi. API ho·∫°t ƒë·ªông t·ªët!',
                    text
                );

            } catch (error) {
                console.error('‚ùå Chat Error:', error);
                showError('L·ªói chat', error.message);
            }
        }

        async function testMentalHealth() {
            showLoading();
            
            try {
                const systemPrompt = `B·∫°n l√† AI Assistant chuy√™n nghi·ªáp v·ªÅ s·ª©c kh·ªèe t√¢m l√Ω cho ph·ª• n·ªØ Vi·ªát Nam. H√£y tr·∫£ l·ªùi b·∫±ng ti·∫øng Vi·ªát, √¢n c·∫ßn v√† chuy√™n nghi·ªáp.`;
                
                const response = await fetch(`${API_URL}?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [
                            {
                                parts: [{ text: systemPrompt }]
                            },
                            {
                                parts: [{ text: 'T√¥i ƒëang c·∫£m th·∫•y stress v√† lo l·∫Øng v·ªÅ c√¥ng vi·ªác. B·∫°n c√≥ th·ªÉ cho t√¥i l·ªùi khuy√™n kh√¥ng?' }]
                            }
                        ],
                        generationConfig: {
                            temperature: 0.7,
                            topK: 40,
                            topP: 0.95,
                            maxOutputTokens: 512,
                        },
                        safetySettings: [
                            {
                                category: 'HARM_CATEGORY_HARASSMENT',
                                threshold: 'BLOCK_NONE'
                            },
                            {
                                category: 'HARM_CATEGORY_HATE_SPEECH',
                                threshold: 'BLOCK_NONE'
                            }
                        ]
                    })
                });

                if (!response.ok) {
                    const error = await response.text();
                    throw new Error(`HTTP ${response.status}: ${error}`);
                }

                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || 'No response';
                
                console.log('‚úÖ Mental Health Response:', text);
                
                showSuccess(
                    'T∆∞ v·∫•n s·ª©c kh·ªèe t√¢m l√Ω th√†nh c√¥ng!', 
                    'Gemini ƒë√£ ph·∫£n h·ªìi chuy√™n nghi·ªáp. API s·∫µn s√†ng cho chatbot!',
                    text
                );

            } catch (error) {
                console.error('‚ùå Mental Health Test Error:', error);
                showError('L·ªói test t∆∞ v·∫•n', error.message);
            }
        }

        // Auto test on load
        window.onload = function() {
            console.log('üîç Testing Gemini API...');
            testAPI();
        };
    </script>
</body>
</html>

